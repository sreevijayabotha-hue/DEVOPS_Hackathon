apiVersion: apps/v1
kind: Deployment
metadata:
  name: spring-app-deployment-nithin
  labels:
    app: spring-app
spec:
  replicas: 2 # You can change this to the desired number of instances
  selector:
    matchLabels:
      app: spring-app
  template:
    metadata:
      labels:
        app: spring-app
    spec:
      containers:
        - name: spring-app-container
          # The image name format expected by the azure/k8s-deploy action
          # The action will replace $(IMAGE_TAG) with the actual SHA tag of the image
          image: test-spring-boot-app/test-spring-boot:$(IMAGE_TAG)
          ports:
            - containerPort: 8080 # The port your Spring Boot app listens on
          resources:
            limits:
              cpu: 500m
              memory: 512Mi
            requests:
              cpu: 250m
              memory: 256Mi
          # Optional: Add liveness and readiness probes for robust deployments
          livenessProbe:
            httpGet:
              path: /actuator/health/liveness # Adjust path if using Spring Boot Actuator
              port: 8080
            initialDelaySeconds: 30
            periodSeconds: 10
          readinessProbe:
            httpGet:
              path: /actuator/health/readiness # Adjust path if using Spring Boot Actuator
              port: 8080
            initialDelaySeconds: 15
            periodSeconds: 5
